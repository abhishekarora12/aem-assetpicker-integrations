!function(){"use strict";var e,t={259:function(){var e=window.wp.blocks,t=window.wp.element,n=window.wp.i18n,r=window.wp.blockEditor,a=window.wp.components,o=JSON.parse('{"u2":"create-block/aemassetpicker"}');(0,e.registerBlockType)(o.u2,{edit:function(e){let{attributes:o,setAttributes:i}=e;const s=o.authorInstanceUrl+"/aem/assetpicker.html",l={image:["jpg","jpeg","png","tiff","svg"],video:["mp4","mkv"]};let c;function u(){var e;window.addEventListener("message",p,{once:!0}),e=s,c=window.open(e,"dam","left=25%,top=25%,height=800,width=1600,status=yes,toolbar=no,menubar=no,location=yes")}function p(e){if(0!=s.indexOf(e.origin))return;let t=JSON.parse(e.data);if(console.log("assetpicker_event_data",t),t.config){let e=t.config;"close"!==e.action&&"done"!==e.action||c&&c.close()}if(t.data){let e=t.data;for(let t in e){let n={};n.img=e[t].img,n.path=e[t].path,n.title=e[t].title,n.url=e[t].url,n.type=e[t].type,n.size=e[t].size;let r=d(n.path);if("image"===r||"video"===r){let e=n.path,t=n.title;i({assetType:r,assetPath:e,assetTitle:t})}else console.log("Error: unknown asset extension!")}}}function d(e){let t=function(e){return e.split(".").pop()}(e);for(let e in l)if(l.hasOwnProperty(e)&&-1!=l[e].indexOf(t))return e;return"image"}function m(e,t){return t?e+"/_jcr_content/renditions/"+t:e}return(0,t.useEffect)((()=>{o.assetPath&&o.authorInstanceUrl&&function(e){let t=function(e){return e.replace("/content/dam","/api/assets")+"/renditions.json"}(e),n=new Headers;fetch(t,{method:"GET",headers:n,redirect:"follow",credentials:"include"}).then((e=>e.json())).then((function(e){let t=function(e){let t=[];return e.entities.forEach((function(e){let n={title:"",icon:"menu"};"assets/asset/renditions/rendition"===e.class[0]&&(n.title=e.properties.name,n.onClick=function(){i({selectedRendition:e.properties.name})}),function(e){return 0===Object.keys(e).length}(n)||t.push(n)})),t}(e);i({renditionsList:t})})).catch((e=>console.log("renditions fetch error",e)))}(o.authorInstanceUrl+o.assetPath)}),[o.assetPath,o.authorInstanceUrl]),(0,t.createElement)("div",(0,r.useBlockProps)(),(0,t.createElement)("div",{className:"aemassetpicker-block"},(0,t.createElement)(r.InspectorControls,{key:"setting"},(0,t.createElement)(a.PanelBody,{title:"Settings",initialOpen:!0},(0,t.createElement)(a.TextControl,{label:"AEM Author URL",value:o.authorInstanceUrl,help:"your aem author instance url",onChange:e=>i({authorInstanceUrl:e})}),(0,t.createElement)(a.TextControl,{label:"AEM Publish URL",value:o.publishInstanceUrl,help:"your aem publish instance url",onChange:e=>i({publishInstanceUrl:e})}),(0,t.createElement)(a.TextControl,{label:"Asset Path",value:o.assetPath,help:"aem dam asset path",onChange:e=>i({assetPath:e})}),(0,t.createElement)(a.TextControl,{label:"Rendition Selected",value:o.selectedRendition,help:"selected asset rendition",onChange:e=>i({selectedRendition:e})}))),(0,t.createElement)(r.BlockControls,null,(0,t.createElement)(a.ToolbarGroup,null,(0,t.createElement)(a.ToolbarButton,{label:"Replace",icon:"controls-repeat",className:"aemassetpicker-replace-button",onClick:u})),(0,t.createElement)(a.ToolbarGroup,null,(0,t.createElement)(a.ToolbarDropdownMenu,{icon:"images-alt2",label:"Renditions",controls:o.renditionsList}))),o.assetPath?(0,t.createElement)("div",{className:"fullWidth boxMargin"},function(e,n,r,a,o){if("image"==n){let n=e+r;return(0,t.createElement)("img",{src:m(n,o),alt:a})}if("video"==n){let n=e+r;return(0,t.createElement)("video",{controls:"",height:"240",width:"320"},(0,t.createElement)("source",{src:n}))}return(0,t.createElement)("p",null,"Please select a supported asset")}(o.authorInstanceUrl,o.assetType,o.assetPath,o.assetTitle,o.selectedRendition)):(0,t.createElement)(a.Placeholder,{icon:"format-image",label:(0,n.__)("AEM Assetpicker","aemassetpicker"),instructions:(0,n.__)("Pick an image/video file from your aem assets library")},(0,t.createElement)("div",{className:"fullWidth boxMargin"},(0,t.createElement)("button",{type:"button",onClick:u,className:"components-button block-editor-media-placeholder__button block-editor-media-placeholder__aemassetpicker-button is-primary"},"AEM Catalog")))))},save:function(e){let{attributes:n,setAttributes:a}=e;function o(e,t){return t?e+"/_jcr_content/renditions/"+t:e}return(0,t.createElement)("div",r.useBlockProps.save(),(0,t.createElement)("div",{className:"aemassetpicker-block"},(0,t.createElement)("div",{className:"fullWidth boxMargin"},function(e,n,r,a,i){if("image"==n){let n=e+r;return(0,t.createElement)("img",{src:o(n,i),alt:a})}if("video"==n){let n=e+r;return(0,t.createElement)("video",{controls:"",height:"240",width:"320"},(0,t.createElement)("source",{src:n}))}return(0,t.createElement)("p",null,"Please select a supported asset")}(n.authorInstanceUrl,n.assetType,n.assetPath,n.assetTitle,n.selectedRendition))))}})}},n={};function r(e){var a=n[e];if(void 0!==a)return a.exports;var o=n[e]={exports:{}};return t[e](o,o.exports,r),o.exports}r.m=t,e=[],r.O=function(t,n,a,o){if(!n){var i=1/0;for(u=0;u<e.length;u++){n=e[u][0],a=e[u][1],o=e[u][2];for(var s=!0,l=0;l<n.length;l++)(!1&o||i>=o)&&Object.keys(r.O).every((function(e){return r.O[e](n[l])}))?n.splice(l--,1):(s=!1,o<i&&(i=o));if(s){e.splice(u--,1);var c=a();void 0!==c&&(t=c)}}return t}o=o||0;for(var u=e.length;u>0&&e[u-1][2]>o;u--)e[u]=e[u-1];e[u]=[n,a,o]},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){var e={826:0,431:0};r.O.j=function(t){return 0===e[t]};var t=function(t,n){var a,o,i=n[0],s=n[1],l=n[2],c=0;if(i.some((function(t){return 0!==e[t]}))){for(a in s)r.o(s,a)&&(r.m[a]=s[a]);if(l)var u=l(r)}for(t&&t(n);c<i.length;c++)o=i[c],r.o(e,o)&&e[o]&&e[o][0](),e[o]=0;return r.O(u)},n=self.webpackChunkaemassetpicker=self.webpackChunkaemassetpicker||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))}();var a=r.O(void 0,[431],(function(){return r(259)}));a=r.O(a)}();